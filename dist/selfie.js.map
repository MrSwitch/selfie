{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","selfie.js","src/lib/viewer.js","src/selfie.js","src/utils/dom/append.js","src/utils/dom/attr.js","src/utils/dom/createElement.js","src/utils/dom/each.js","src/utils/dom/isDom.js","src/utils/dom/objectfit.js","src/utils/dom/prepend.js","src/utils/dom/query.js","src/utils/events/on.js","src/utils/events/ready.js","src/utils/object/instanceOf.js","src/utils/object/toArray.js","src/utils/string/param.js","src/utils/support/canvasToBlob.js","src/utils/support/getUserMedia.js","src/utils/support/requestAnimationFrame.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_utilsDomAppendJs","_utilsDomAppendJs2","_utilsDomQueryJs","_utilsDomQueryJs2","_utilsStringParamJs","_utilsStringParamJs2","_utilsEventsOnJs","_utilsEventsOnJs2","viewerCSSText","position","left","right","top","bottom","z-index","background-color","viewerContentCSSText","text-align","viewerImgCSSText","max-width","max-height","url","elm","content","hidden","class","style","controls","close_btn","onclick","appendChild","document","createTextNode","keyCode","preventDefault","stopPropagation","innerHTML","src","../utils/dom/append.js","../utils/dom/query.js","../utils/events/on.js","../utils/string/param.js",2,"keypress","charCode","record","stream","active","source","canvas","toBlob","handleBlob","cameraPower","blob","photos","getPhotos","URL","createObjectURL","_utilsDomPrependJs2","height","imgCSSText","_libViewerJs2","scrollLeft","_utilsSupportGetUserMediaJs2","video","audio","cameraOn","cameraOff","_stream","getVideo","getCanvasContext","draw","_objectFit","_utilsDomObjectfitJs2","videoWidth","videoHeight","width","_objectFit2","_slicedToArray","x","y","w","h","drawImage","_utilsSupportRequestAnimationFrameJs2","console","log","container","id","videoCSSText","window","muted","autoplay","play","onerror","event","stop","canvasCSSText","clientWidth","clientHeight","getContext","photosCSSText","sliceIterator","arr","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","next","done","push","err","Array","isArray","TypeError","_utilsEventsReadyJs","_utilsEventsReadyJs2","_utilsSupportGetUserMediaJs","_utilsSupportRequestAnimationFrameJs","_utilsDomPrependJs","_utilsDomObjectfitJs","_libViewerJs","display","white-space","overflow","border","./lib/viewer.js","./utils/dom/append.js","./utils/dom/objectfit.js","./utils/dom/prepend.js","./utils/dom/query.js","./utils/events/on.js","./utils/events/ready.js","./utils/string/param.js","./utils/support/canvasToBlob.js","./utils/support/getUserMedia.js","./utils/support/requestAnimationFrame.js",3,"_createElementJs","_createElementJs2","tagName","prop","parent","arguments","body","./createElement.js",4,"_eachJs","_eachJs2","elements","props","element","setAttribute","./each.js",5,"_attrJs","_attrJs2","attrs","createElement","./attr.js",6,"_isDomJs","_isDomJs2","_objectInstanceOfJs","_objectInstanceOfJs2","_objectToArrayJs","_objectToArrayJs2","matches","callback","querySelectorAll","forEach","../object/instanceOf.js","../object/toArray.js","./isDom.js",7,"_HTMLElement","HTMLElement","Element","_HTMLDocument","HTMLDocument","Document","_Window","constructor","test",8,"item_width","item_height","target_width","target_height","item_r","target_r","offsetLeft","offsetTop","Math","round",9,"insertBefore","firstChild",10,"query","querySelector",11,"_domEachJs","_domEachJs2","SEPERATOR","eventnames","useCapture","split","el","eventname","addEventListener","../dom/each.js",12,"_onJs","_onJs2","readyState","./on.js",13,"root",14,"prototype","slice",15,"hash","delimiter","seperator","formatFunction","keys","map","name","join",16,"canvasToBlob","type","quality","binStr","atob","this","toDataURL","len","Uint8Array","charCodeAt","Blob","HTMLCanvasElement",17,"_getUserMedia","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","oGetUserMedia","c","bind","constraints","success","failure",18,"requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","setTimeout"],"mappings":"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","file":"selfie.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",null,"// viewer\nimport append from '../utils/dom/append.js';\nimport query from '../utils/dom/query.js';\nimport param from '../utils/string/param.js';\nimport on from '../utils/events/on.js';\n\nconst viewerCSSText =  param({\n\tposition: 'fixed',\n\tleft: 0,\n\tright: 0,\n\ttop: 0,\n\tbottom: 0,\n\t'z-index': 1,\n\t'background-color': 'rgba(0,0,0,0.8)'\n}, ';', ':');\n\nconst viewerContentCSSText = param({\n\tposition: 'absolute',\n\tleft: '5%',\n\tright: '5%',\n\ttop: '5%',\n\tbottom: '5%',\n\t'text-align': 'center'\n}, ';', ':');\n\nconst viewerImgCSSText = param({\n\t'max-width': '100%',\n\t'max-height': '100%'\n}, ';', ':');\n\nexport default (url) => {\n\n\tvar elm = query('.viewer');\n\tvar content = query('.viewer-content');\n\n\tif (!elm) {\n\t\telm = append('div', {'class': 'viewer', style: viewerCSSText});\n\t\tvar controls = append('div', {'class': 'viewer-controls'}, elm);\n\n\t\t// Create close button\n\t\tvar close_btn = append('button', {\n\t\t\t'class': 'viewer-close',\n\t\t\t'onclick': () => {\n\t\t\t\telm.hidden = true;\n\t\t\t}\n\t\t}, controls);\n\t\tclose_btn.appendChild(document.createTextNode('X'));\n\n\t\tcontent = append('div', {'class': 'viewer-content', style: viewerContentCSSText}, elm);\n\n\t\ton(document, 'keypress', (e) => {\n\t\t\tif (!elm.hidden && e.keyCode === 32) {\n\t\t\t\telm.hidden = true;\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t});\n\t}\n\telse if(elm.hidden) {\n\t\telm.hidden = false;\n\t}\n\n\tcontent.innerHTML = '';\n\n\t// Create an image there\n\tvar img = append('img', {src: url, style: viewerImgCSSText}, content);\n};\n","import on from './utils/events/on.js';\nimport ready from './utils/events/ready.js';\nimport getUserMedia from './utils/support/getUserMedia.js';\nimport requestAnimationFrame from './utils/support/requestAnimationFrame.js';\nimport append from './utils/dom/append.js';\nimport prepend from './utils/dom/prepend.js';\nimport query from './utils/dom/query.js';\nimport param from './utils/string/param.js';\nimport objectFit from './utils/dom/objectfit.js';\nimport './utils/support/canvasToBlob.js';\n\nimport viewer from './lib/viewer.js';\n\nconst canvasCSSText = param({\n\tposition: 'absolute',\n\tleft: 0,\n\ttop: 0,\n\twidth: '100%',\n\theight: '100%',\n\t'background-color': '#ccc'\n}, ';', ':');\n\nconst videoCSSText = param({\n\tdisplay: 'none',\n}, ';', ':');\n\nconst photosCSSText = param({\n\tposition: 'absolute',\n\t'white-space': 'nowrap',\n\t'overflow': 'auto',\n\theight: '10%',\n\tbottom: 0,\n\tleft: 0,\n\tright: 0\n}, ';', ':');\n\nconst imgCSSText = param({\n\tdisplay: 'inline-block',\n\tborder: '1vh solid white'\n}, ';', ':');\n\n\nvar container;\nvar video, source, stream;\n\n\nready(() => {\n\n\t// define the container for selfie\n\tcontainer = query('.selfie');\n\n\t// Get\n\tsource = getCanvasContext();\n\n\ton(source.canvas, 'click, touchstart', record);\n\n\t// Trigger the getUserMedia\n\tcameraPower();\n\n\t// Bind listeners\n\ton(window, 'resize', getCanvasContext);\n\n\t// Bind listeners\n\ton(document, 'keypress', keypress);\n});\n\nfunction keypress(e) {\n\tif (e.charCode === 32) {\n\t\trecord(e);\n\t}\n}\n\nfunction record(e) {\n\t// Get the image data from the source\n\tif (stream && stream.active) {\n\t\tsource.canvas.toBlob(handleBlob);\n\t}\n\telse{\n\t\tcameraPower();\n\t}\n\n\tif (e) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t}\n}\n\nfunction handleBlob(blob) {\n\t// Create an image in photos\n\tvar photos = getPhotos();\n\n\t// URL\n\tvar url = URL.createObjectURL(blob);\n\n\t// Create a new image\n\tprepend('img', {\n\t\tsrc: url,\n\t\theight: '100%',\n\t\tstyle: imgCSSText,\n\t\tonclick: () => {\n\t\t\tviewer(url);\n\t\t}\n\t}, photos);\n\n\t// Ensure its in focus\n\tphotos.scrollLeft = 0;\n}\n\nfunction cameraPower() {\n\tgetUserMedia({video: true, audio: true}, cameraOn, cameraOff);\n}\n\nfunction cameraOn(_stream) {\n\n\tstream = _stream;\n\n\t// turn the stream into a Object and apply it to a video tag.\n\tvideo = getVideo(_stream);\n\n\t// Get the canvas we're going to draw\n\tsource = getCanvasContext();\n\n\t// Start drawing the video to the canvas\n\tdraw();\n}\n\nfunction draw() {\n\t// draw the image so that the content puts it into the\n\tlet [x,y,w,h] = objectFit(video.videoWidth, video.videoHeight, source.canvas.width, source.canvas.height);\n\n\t// Draw to the source\n\tsource.drawImage(video, x, y, w, h);\n\n\t// Do this repeatedly\n\trequestAnimationFrame(draw);\n}\n\nfunction cameraOff(e) {\n\t// Process an error event\n\tconsole.log(e);\n}\n\n\nfunction getVideo(stream) {\n\n\tvar elm = query('#source', container);\n\n\tif (!elm) {\n\t\telm = append('video', {id: 'source', style: videoCSSText, hidden:true}, container);\n\t}\n\n\t// Apply the document object reference\n\telm.src = window.URL.createObjectURL(stream);\n\n\t// Ensure this is muted, we dont want to hear ourselves\n\telm.muted = true;\n\n\t// Play content, not sure both are required, but hey\n\telm.autoplay = true;\n\telm.play();\n\n\t// Attach the stream to the UI\n\telm.onerror = function(event) {\n\t\tstream.stop();\n\t};\n\n\treturn elm;\n}\n\n\nfunction getCanvasContext() {\n\n\tvar elm = query('canvas', container);\n\n\tif (!elm) {\n\t\telm = append('canvas', {style: canvasCSSText}, container);\n\t}\n\t// Ensure the canvas object fills the screen\n\telm.width = elm.clientWidth;\n\telm.height = elm.clientHeight;\n\n\n\t// Get Canvas Context\n\treturn elm.getContext('2d');\n}\n\n\nfunction getPhotos() {\n\n\tvar elm = query('div.photos');\n\n\tif (!elm) {\n\t\telm = append('div', {'class': 'photos', style: photosCSSText}, container);\n\t}\n\n\treturn elm;\n}\n","import createElement from './createElement.js';\n\nexport default (tagName, prop, parent = document.body) => {\n\tlet elm = createElement(tagName, prop);\n\tparent.appendChild(elm);\n\treturn elm;\n};\n","import each from './each.js';\n\nexport default (elements, props) => {\n\treturn each(elements, (element) => {\n\t\tfor (let x in props) {\n\t\t\tlet prop = props[x];\n\t\t\tif (typeof prop === 'function') {\n\t\t\t\telement[x] = prop;\n\t\t\t}\n\t\t\telse{\n\t\t\t\telement.setAttribute(x, prop);\n\t\t\t}\n\t\t}\n\t});\n};\n","import attr from './attr.js';\n\nexport default (tagName, attrs) => {\n\tlet elm = document.createElement(tagName);\n\tattr(elm, attrs);\n\treturn elm;\n};\n","import isDom from './isDom.js';\nimport instanceOf from '../object/instanceOf.js';\nimport toArray from '../object/toArray.js';\n\nexport default (matches, callback = function(){}) => {\n\n\tif (isDom(matches)) {\n\t\tmatches = [matches];\n\t}\n\telse if (typeof(matches) === 'string') {\n\t\tmatches = document.querySelectorAll(matches);\n\t}\n\n\tif (!instanceOf(matches, Array)) {\n\t\tmatches = toArray(matches);\n\t}\n\n\tif (callback) {\n\t\tmatches.forEach(callback);\n\t}\n\n\treturn matches;\n};\n","import instanceOf from '../object/instanceOf.js';\n\nconst _HTMLElement = typeof HTMLElement !== 'undefined' ? HTMLElement : Element;\nconst _HTMLDocument = typeof HTMLDocument !== 'undefined' ? HTMLDocument : Document;\nconst _Window = window.constructor;\n\nexport default (test) => {\n\treturn instanceOf(test, _HTMLElement) ||\n\t\t\tinstanceOf(test, _HTMLDocument) ||\n\t\t\tinstanceOf(test, _Window);\n};\n","// Object-Fit\n//  Maps an item to the width and the height of an item using the cover command\n// Returns the coordinatates and the new width and height of the item being drawn on the target\nexport default (item_width, item_height, target_width, target_height) => {\n\n\t// Deterine the ratio\n\tvar item_r = item_height / item_width;\n\tvar target_r = target_height / target_width;\n\n\t// initial offset points\n\tvar offsetLeft = 0,\n\t\toffsetTop = 0;\n\n\t// Window is proportionally taller than image\n\tif (target_r > item_r) {\n\t\t// Get the horiontal middle offset\n\t\toffsetLeft = Math.round(((target_height / item_r) - target_width));\n\t}\n\t// Window is proportionally narrower than the image\n\telse if(target_r < item_r) {\n\t\t// Get the vertical middle offset\n\t\toffsetTop = Math.round(((target_width * item_r) - target_height));\n\t}\n\n\t// Returns the new [x,y,w,h];\n\treturn [-offsetLeft/2, -offsetTop/2, target_width + offsetLeft, target_height + offsetTop];\n};\n","import createElement from './createElement.js';\n\nexport default (tagName, prop, parent = document.body) => {\n\tlet elm = createElement(tagName, prop);\n\tparent.insertBefore(elm, parent.firstChild);\n\treturn elm;\n};\n","// Select a single element\nexport default (query, parent = document) => {\n\treturn parent.querySelector(query);\n};\n","// on.js\n// Listen to events, this is a wrapper for addEventListener\n\nimport each from '../dom/each.js';\nconst SEPERATOR = /[\\s\\,]+/;\n\nexport default (elements, eventnames, callback, useCapture = false) => {\n\teventnames = eventnames.split(SEPERATOR);\n\treturn each(elements, (el) => {\n\t\teventnames.forEach((eventname) => el.addEventListener(eventname, callback, useCapture) );\n\t});\n};\n","import on from './on.js';\n\nexport default (callback) => {\n\tif (document.readyState !== \"loading\" && document.body) {\n\t\tcallback();\n\t}\n\telse {\n\t\ton(document, 'DOMContentLoaded', callback);\n\t}\n};\n","export default (test, root) => {\n\treturn root && test instanceof root;\n};\n","export default (obj) => {\n\treturn Array.prototype.slice.call(obj);\n};\n","// Param\n// Explode/encode the parameters of an URL string/object\n// @param string s, string to decode\nexport default (hash, delimiter = '&', seperator = '=', formatFunction = function(o){return o;}) => {\n\treturn Object.keys(hash).map((name) => {\n\t\tvar value = formatFunction(hash[name]);\n\t\treturn name + (value !== null ? seperator + value : '');\n\t}).join(delimiter);\n};\n","export default function canvasToBlob(callback, type, quality) {\n\tvar binStr = atob(this.toDataURL(type, quality).split(',')[1]),\n\t\tlen = binStr.length,\n\t\tarr = new Uint8Array(len);\n\n\tfor (var i = 0; i < len; i++) {\n\t\tarr[i] = binStr.charCodeAt(i);\n\t}\n\n\tcallback( new Blob( [arr], {type: type || 'image/png'} ) );\n}\n\nif (!HTMLCanvasElement.prototype.toBlob) {\n\tObject.defineProperty(HTMLCanvasElement.prototype, 'toBlob', {\n\t\tvalue: canvasToBlob\n\t});\n}\n","// Shim up the getUserMedia API\n// Wrap this to a custom variable but bind it on the navigator object to work\nvar _getUserMedia = (\n\tnavigator.getUserMedia ||\n\tnavigator.webkitGetUserMedia ||\n\tnavigator.mozGetUserMedia ||\n\tnavigator.msGetUserMedia ||\n\tnavigator.oGetUserMedia ||\n\tfunction(c, s, e) {\n\t\te(new Error('getUserMedia is not supported'));\n\t}\n).bind(navigator);\n\nexport default (constraints, success, failure) => {\n\ttry{\n\t\t_getUserMedia(constraints, success, failure);\n\t}\n\tcatch(e){\n\t\ttry{\n\t\t\t// provide a string of constraints\n\t\t\t_getUserMedia( Object.keys(constraints).join(','), success, failure);\n\t\t}\n\t\tcatch(_e){\n\t\t\tfailure();\n\t\t}\n\t}\n};\n","// requestAnimationFrame polyfill\nwindow.requestAnimationFrame =\n\twindow.requestAnimationFrame ||\n\twindow.webkitRequestAnimationFrame ||\n\twindow.mozRequestAnimationFrame ||\n\twindow.oRequestAnimationFrame ||\n\twindow.msRequestAnimationFrame ||\n\tfunction (callback) {\n\t\twindow.setTimeout(callback, 1000 / 60);\n\t};\n\nexport default window.requestAnimationFrame.bind(window);\n"],"sourceRoot":"/source/"}