{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","selfie.js","src/lib/viewer.js","src/selfie.js","src/utils/dom/append.js","src/utils/dom/attr.js","src/utils/dom/createElement.js","src/utils/dom/each.js","src/utils/dom/isDom.js","src/utils/dom/objectfit.js","src/utils/dom/query.js","src/utils/events/on.js","src/utils/events/ready.js","src/utils/object/instanceOf.js","src/utils/object/toArray.js","src/utils/string/param.js","src/utils/support/canvasToBlob.js","src/utils/support/getUserMedia.js","src/utils/support/requestAnimationFrame.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_utilsDomAppendJs","_utilsDomAppendJs2","_utilsDomQueryJs","_utilsDomQueryJs2","_utilsStringParamJs","_utilsStringParamJs2","_utilsEventsOnJs","_utilsEventsOnJs2","viewerCSSText","position","left","right","top","bottom","z-index","background-color","viewerContentCSSText","text-align","viewerImgCSSText","max-width","max-height","url","elm","content","hidden","class","style","controls","close_btn","onclick","appendChild","document","createTextNode","keyCode","preventDefault","stopPropagation","innerHTML","src","../utils/dom/append.js","../utils/dom/query.js","../utils/events/on.js","../utils/string/param.js",2,"keypress","charCode","record","stream","active","source","canvas","toBlob","handleBlob","cameraPower","blob","photos","getPhotos","URL","createObjectURL","width","imgCSSText","_libViewerJs2","_utilsSupportGetUserMediaJs2","video","audio","cameraOn","cameraOff","_stream","getVideo","getCanvasContext","draw","_objectFit","_utilsDomObjectfitJs2","videoWidth","videoHeight","height","_objectFit2","_slicedToArray","x","y","w","h","drawImage","_utilsSupportRequestAnimationFrameJs2","console","log","container","id","videoCSSText","window","muted","autoplay","play","onerror","event","stop","canvasCSSText","clientWidth","clientHeight","getContext","photosCSSText","sliceIterator","arr","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","next","done","push","err","Array","isArray","TypeError","_utilsEventsReadyJs","_utilsEventsReadyJs2","_utilsSupportGetUserMediaJs","_utilsSupportRequestAnimationFrameJs","_utilsDomObjectfitJs","_libViewerJs","display","border","./lib/viewer.js","./utils/dom/append.js","./utils/dom/objectfit.js","./utils/dom/query.js","./utils/events/on.js","./utils/events/ready.js","./utils/string/param.js","./utils/support/canvasToBlob.js","./utils/support/getUserMedia.js","./utils/support/requestAnimationFrame.js",3,"_createElementJs","_createElementJs2","tagName","prop","parent","arguments","body","./createElement.js",4,"_eachJs","_eachJs2","elements","props","element","setAttribute","./each.js",5,"_attrJs","_attrJs2","attrs","createElement","./attr.js",6,"_isDomJs","_isDomJs2","_objectInstanceOfJs","_objectInstanceOfJs2","_objectToArrayJs","_objectToArrayJs2","matches","callback","querySelectorAll","forEach","../object/instanceOf.js","../object/toArray.js","./isDom.js",7,"_HTMLElement","HTMLElement","Element","_HTMLDocument","HTMLDocument","Document","_Window","constructor","test",8,"item_width","item_height","target_width","target_height","item_r","target_r","offsetLeft","offsetTop","Math","round",9,"query","querySelector",10,"_domEachJs","_domEachJs2","SEPERATOR","eventnames","useCapture","split","el","eventname","addEventListener","../dom/each.js",11,"_onJs","_onJs2","readyState","./on.js",12,"root",13,"prototype","slice",14,"hash","delimiter","seperator","formatFunction","keys","map","name","join",15,"canvasToBlob","type","quality","binStr","atob","this","toDataURL","len","Uint8Array","charCodeAt","Blob","HTMLCanvasElement",16,"_getUserMedia","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","oGetUserMedia","c","bind","constraints","success","failure",17,"requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","setTimeout"],"mappings":"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","file":"selfie.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",null,"// viewer\nimport append from '../utils/dom/append.js';\nimport query from '../utils/dom/query.js';\nimport param from '../utils/string/param.js';\nimport on from '../utils/events/on.js';\n\nconst viewerCSSText =  param({\n\tposition: 'fixed',\n\tleft: 0,\n\tright: 0,\n\ttop: 0,\n\tbottom: 0,\n\t'z-index': 1,\n\t'background-color': 'rgba(0,0,0,0.8)'\n}, ';', ':');\n\nconst viewerContentCSSText = param({\n\tposition: 'absolute',\n\tleft: '5%',\n\tright: '5%',\n\ttop: '5%',\n\tbottom: '5%',\n\t'text-align': 'center'\n}, ';', ':');\n\nconst viewerImgCSSText = param({\n\t'max-width': '100%',\n\t'max-height': '100%'\n}, ';', ':');\n\nexport default (url) => {\n\n\tvar elm = query('.viewer');\n\tvar content = query('.viewer-content');\n\n\tif (!elm) {\n\t\telm = append('div', {'class': 'viewer', style: viewerCSSText});\n\t\tvar controls = append('div', {'class': 'viewer-controls'}, elm);\n\n\t\t// Create close button\n\t\tvar close_btn = append('button', {\n\t\t\t'class': 'viewer-close',\n\t\t\t'onclick': () => {\n\t\t\t\telm.hidden = true;\n\t\t\t}\n\t\t}, controls);\n\t\tclose_btn.appendChild(document.createTextNode('X'));\n\n\t\tcontent = append('div', {'class': 'viewer-content', style: viewerContentCSSText}, elm);\n\n\t\ton(document, 'keypress', (e) => {\n\t\t\tif (!elm.hidden && e.keyCode === 32) {\n\t\t\t\telm.hidden = true;\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t});\n\t}\n\telse if(elm.hidden) {\n\t\telm.hidden = false;\n\t}\n\n\tcontent.innerHTML = '';\n\n\t// Create an image there\n\tvar img = append('img', {src: url, style: viewerImgCSSText}, content);\n};\n","import on from './utils/events/on.js';\nimport ready from './utils/events/ready.js';\nimport getUserMedia from './utils/support/getUserMedia.js';\nimport requestAnimationFrame from './utils/support/requestAnimationFrame.js';\nimport append from './utils/dom/append.js';\nimport query from './utils/dom/query.js';\nimport param from './utils/string/param.js';\nimport objectFit from './utils/dom/objectfit.js';\nimport './utils/support/canvasToBlob.js';\n\nimport viewer from './lib/viewer.js';\n\nconst canvasCSSText = param({\n\tposition: 'absolute',\n\tleft: 0,\n\ttop: 0,\n\twidth: '100%',\n\theight: '100%',\n\t'background-color': '#ccc'\n}, ';', ':');\n\nconst videoCSSText = param({\n\tdisplay:'none',\n}, ';', ':');\n\nconst photosCSSText = param({\n\tposition:'absolute',\n\tbottom:0,\n\tleft:0,\n\tright:0\n}, ';', ':');\n\nconst imgCSSText = param({\n\tdisplay: 'inline-block',\n\tborder: '10px solid white'\n}, ';', ':');\n\n\nvar container;\nvar video, source, stream;\n\n\nready(() => {\n\n\t// define the container for selfie\n\tcontainer = query('.selfie');\n\n\t// Get\n\tsource = getCanvasContext();\n\n\ton(source.canvas, 'click, touchstart', record);\n\n\t// Trigger the getUserMedia\n\tcameraPower();\n\n\t// Bind listeners\n\ton(window, 'resize', getCanvasContext);\n\n\t// Bind listeners\n\ton(document, 'keypress', keypress);\n});\n\nfunction keypress(e) {\n\tif (e.charCode === 32) {\n\t\trecord();\n\t}\n}\n\nfunction record() {\n\t// Get the image data from the source\n\tif (stream && stream.active) {\n\t\tsource.canvas.toBlob(handleBlob);\n\t}\n\telse{\n\t\tcameraPower();\n\t}\n}\n\nfunction handleBlob(blob) {\n\t// Create an image in photos\n\tvar photos = getPhotos();\n\n\t// URL\n\tvar url = URL.createObjectURL(blob);\n\n\t// Create a new image\n\tappend('img', {\n\t\tsrc: url,\n\t\twidth: '100px',\n\t\tstyle: imgCSSText,\n\t\tonclick: () => {\n\t\t\tviewer(url);\n\t\t}\n\t}, photos);\n}\n\nfunction cameraPower() {\n\tgetUserMedia({video: true, audio: true}, cameraOn, cameraOff);\n}\n\nfunction cameraOn(_stream) {\n\n\tstream = _stream;\n\n\t// turn the stream into a Object and apply it to a video tag.\n\tvideo = getVideo(_stream);\n\n\t// Get the canvas we're going to draw\n\tsource = getCanvasContext();\n\n\t// Start drawing the video to the canvas\n\tdraw();\n}\n\nfunction draw() {\n\t// draw the image so that the content puts it into the\n\tlet [x,y,w,h] = objectFit(video.videoWidth, video.videoHeight, source.canvas.width, source.canvas.height);\n\n\t// Draw to the source\n\tsource.drawImage(video, x, y, w, h);\n\n\t// Do this repeatedly\n\trequestAnimationFrame(draw);\n}\n\nfunction cameraOff(e) {\n\t// Process an error event\n\tconsole.log(e);\n}\n\n\nfunction getVideo(stream) {\n\n\tvar elm = query('#source', container);\n\n\tif (!elm) {\n\t\telm = append('video', {id: 'source', style: videoCSSText, hidden:true}, container);\n\t}\n\n\t// Apply the document object reference\n\telm.src = window.URL.createObjectURL(stream);\n\n\t// Ensure this is muted, we dont want to hear ourselves\n\telm.muted = true;\n\n\t// Play content, not sure both are required, but hey\n\telm.autoplay = true;\n\telm.play();\n\n\t// Attach the stream to the UI\n\telm.onerror = function(event) {\n\t\tstream.stop();\n\t};\n\n\treturn elm;\n}\n\n\nfunction getCanvasContext() {\n\n\tvar elm = query('canvas', container);\n\n\tif (!elm) {\n\t\telm = append('canvas', {style: canvasCSSText}, container);\n\t}\n\t// Ensure the canvas object fills the screen\n\telm.width = elm.clientWidth;\n\telm.height = elm.clientHeight;\n\n\n\t// Get Canvas Context\n\treturn elm.getContext('2d');\n}\n\n\nfunction getPhotos() {\n\n\tvar elm = query('div.photos');\n\n\tif (!elm) {\n\t\telm = append('div', {'class': 'photos', style: photosCSSText}, container);\n\t}\n\n\treturn elm;\n}\n","import createElement from './createElement.js';\n\nexport default (tagName, prop, parent = document.body) => {\n\tlet elm = createElement(tagName, prop);\n\tparent.appendChild(elm);\n\treturn elm;\n};\n","import each from './each.js';\n\nexport default (elements, props) => {\n\treturn each(elements, (element) => {\n\t\tfor (let x in props) {\n\t\t\tlet prop = props[x];\n\t\t\tif (typeof prop === 'function') {\n\t\t\t\telement[x] = prop;\n\t\t\t}\n\t\t\telse{\n\t\t\t\telement.setAttribute(x, prop);\n\t\t\t}\n\t\t}\n\t});\n};\n","import attr from './attr.js';\n\nexport default (tagName, attrs) => {\n\tlet elm = document.createElement(tagName);\n\tattr(elm, attrs);\n\treturn elm;\n};\n","import isDom from './isDom.js';\nimport instanceOf from '../object/instanceOf.js';\nimport toArray from '../object/toArray.js';\n\nexport default (matches, callback = function(){}) => {\n\n\tif (isDom(matches)) {\n\t\tmatches = [matches];\n\t}\n\telse if (typeof(matches) === 'string') {\n\t\tmatches = document.querySelectorAll(matches);\n\t}\n\n\tif (!instanceOf(matches, Array)) {\n\t\tmatches = toArray(matches);\n\t}\n\n\tif (callback) {\n\t\tmatches.forEach(callback);\n\t}\n\n\treturn matches;\n};\n","import instanceOf from '../object/instanceOf.js';\n\nconst _HTMLElement = typeof HTMLElement !== 'undefined' ? HTMLElement : Element;\nconst _HTMLDocument = typeof HTMLDocument !== 'undefined' ? HTMLDocument : Document;\nconst _Window = window.constructor;\n\nexport default (test) => {\n\treturn instanceOf(test, _HTMLElement) ||\n\t\t\tinstanceOf(test, _HTMLDocument) ||\n\t\t\tinstanceOf(test, _Window);\n};\n","// Object-Fit\n//  Maps an item to the width and the height of an item using the cover command\n// Returns the coordinatates and the new width and height of the item being drawn on the target\nexport default (item_width, item_height, target_width, target_height) => {\n\n\t// Deterine the ratio\n\tvar item_r = item_height / item_width;\n\tvar target_r = target_height / target_width;\n\n\t// initial offset points\n\tvar offsetLeft = 0,\n\t\toffsetTop = 0;\n\n\t// Window is proportionally taller than image\n\tif (target_r > item_r) {\n\t\t// Get the horiontal middle offset\n\t\toffsetLeft = Math.round(((target_height / item_r) - target_width));\n\t}\n\t// Window is proportionally narrower than the image\n\telse if(target_r < item_r) {\n\t\t// Get the vertical middle offset\n\t\toffsetTop = Math.round(((target_width * item_r) - target_height));\n\t}\n\n\t// Returns the new [x,y,w,h];\n\treturn [-offsetLeft/2, -offsetTop/2, target_width + offsetLeft, target_height + offsetTop];\n};\n","// Select a single element\nexport default (query, parent = document) => {\n\treturn parent.querySelector(query);\n};\n","// on.js\n// Listen to events, this is a wrapper for addEventListener\n\nimport each from '../dom/each.js';\nconst SEPERATOR = /[\\s\\,]+/;\n\nexport default (elements, eventnames, callback, useCapture = false) => {\n\teventnames = eventnames.split(SEPERATOR);\n\treturn each(elements, (el) => {\n\t\teventnames.forEach((eventname) => el.addEventListener(eventname, callback, useCapture) );\n\t});\n};\n","import on from './on.js';\n\nexport default (callback) => {\n\tif (document.readyState !== \"loading\" && document.body) {\n\t\tcallback();\n\t}\n\telse {\n\t\ton(document, 'DOMContentLoaded', callback);\n\t}\n};\n","export default (test, root) => {\n\treturn root && test instanceof root;\n};\n","export default (obj) => {\n\treturn Array.prototype.slice.call(obj);\n};\n","// Param\n// Explode/encode the parameters of an URL string/object\n// @param string s, string to decode\nexport default (hash, delimiter = '&', seperator = '=', formatFunction = function(o){return o;}) => {\n\treturn Object.keys(hash).map((name) => {\n\t\tvar value = formatFunction(hash[name]);\n\t\treturn name + (value !== null ? seperator + value : '');\n\t}).join(delimiter);\n};\n","export default function canvasToBlob(callback, type, quality) {\n\tvar binStr = atob(this.toDataURL(type, quality).split(',')[1]),\n\t\tlen = binStr.length,\n\t\tarr = new Uint8Array(len);\n\n\tfor (var i = 0; i < len; i++) {\n\t\tarr[i] = binStr.charCodeAt(i);\n\t}\n\n\tcallback( new Blob( [arr], {type: type || 'image/png'} ) );\n}\n\nif (!HTMLCanvasElement.prototype.toBlob) {\n\tObject.defineProperty(HTMLCanvasElement.prototype, 'toBlob', {\n\t\tvalue: canvasToBlob\n\t});\n}\n","// Shim up the getUserMedia API\n// Wrap this to a custom variable but bind it on the navigator object to work\nvar _getUserMedia = (\n\tnavigator.getUserMedia ||\n\tnavigator.webkitGetUserMedia ||\n\tnavigator.mozGetUserMedia ||\n\tnavigator.msGetUserMedia ||\n\tnavigator.oGetUserMedia ||\n\tfunction(c, s, e) {\n\t\te(new Error('getUserMedia is not supported'));\n\t}\n).bind(navigator);\n\nexport default (constraints, success, failure) => {\n\ttry{\n\t\t_getUserMedia(constraints, success, failure);\n\t}\n\tcatch(e){\n\t\ttry{\n\t\t\t// provide a string of constraints\n\t\t\t_getUserMedia( Object.keys(constraints).join(','), success, failure);\n\t\t}\n\t\tcatch(_e){\n\t\t\tfailure();\n\t\t}\n\t}\n};\n","// requestAnimationFrame polyfill\nwindow.requestAnimationFrame =\n\twindow.requestAnimationFrame ||\n\twindow.webkitRequestAnimationFrame ||\n\twindow.mozRequestAnimationFrame ||\n\twindow.oRequestAnimationFrame ||\n\twindow.msRequestAnimationFrame ||\n\tfunction (callback) {\n\t\twindow.setTimeout(callback, 1000 / 60);\n\t};\n\nexport default window.requestAnimationFrame.bind(window);\n"],"sourceRoot":"/source/"}